---
editor_options: 
  markdown: 
    wrap: 72
---

# IDEAS Quality-Control (QC) multi-slice generator

**Imaging Dementia-Evidence for Amyloid Scanning** (IDEAS,
(<https://www.ideas-study.org>))

## Overview

This repository contains code for generating multi-slice figures in
three projections (axial, sagittal, and coronal) for PET images of
interest. The output includes two figures per scan: one with the PET
image alone, and one with overlays of reference and target regions of
interest on the PET image.

Image processing is not part of the current script but can be done using
the rPOP pipeline (see [rPOP on
GitHub](https://github.com/LeoIacca/rPOP)). PET output files processed
with rPOP are fully compatible with this script.

## Contact

This code was generated by the PET team at the Memory and Aging Center,
Department of Neurology, University of California, San Francisco. For
questions, please contact Renaud La Joie at renaud.lajoie\@ucsf.edu.

## Structure of the code

Code is implemented in MATLAB (version 2023b) and requires the
Statistical Parametric Mapping v12 (SPM12) toolbox (publicly available
at [SPM12](https://www.fil.ion.ucl.ac.uk/spm/software/spm12/)) to be
installed.

Functions required to execute the code are located under **/run**. The
main script **IDEAS_QC.m** will call **setup_multislices.m** to select
the scans and regions required for processing. All defaults for the
generated images are indicated there.

The script requires input files to be 3D NIfTI files (4D files are not
supported) in common space. Slice selection is hard-coded: if you need
to modify the selected slices, please see
**run/get_plane_parameters.m**.

## Running IDEAS-QC

Download the whole IDEAS-QC package from the repository, unzip it, and
copy it into your MATLAB search path. In MATLAB, navigate to the folder
with IDEAS_QC and type the following command in the MATLAB command
window, then press enter:

> IDEAS_QC

#### You will first be asked to provide the path to the directory with PET NIfTI files you want to QC

Please select the directory in the opened input window.

#### Next, you will be asked to provide the path to the directory with the ROI NIfTI files you want to QC

Please select the directory in the opened input window.

#### If SPM12 is not on your MATLAB path, you will be asked to provide the path to SPM12 directory

Please select the directory in the opened input window.

#### You will be then asked if you want to overwrite files that were previously generated

Please input **y** (for yes) or **n** (for no) in the MATLAB command
window.

#### As the last step, you will be asked to select ROIs from all available in your specified folder

Please select one or multiple files in the opened input window.

If the Parallel Computing Toolbox is installed, the code will attempt to
process files in parallel to speed up file generation.

Output files will be saved in the **/output_slices** directory. Files
ending with **0** are PET only, and those with **1** are PET overlaid
with ROI.

## Demo files

This codebase includes a **/Demo** directory with NIfTI files of 6
patients in **/Demo/patient** and 2 ROIs in **/Demo/roi**. Please select
**/Demo/patient** as the directory with your PET files of interest and
**/Demo/roi** as the directory of your ROI files. When asked to select
ROI files, please select both **1_target** and **2_reference** files.

The script will produce files for QC exactly as used by the UCSF PET
team to QC images for IDEAS. You can find examples of generated output
in **/Demo/output_example.**
